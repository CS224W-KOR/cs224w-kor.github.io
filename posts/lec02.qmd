---
toc: true
title: "Lecture 2"
description: Traditional Methods for Machine Learning in Graphs
author: "JooHo Kim"
date: "2022-07-13"
categories: [LEC02]
---

# Lecture2 ì •ë¦¬


2ê°•ì—ì„  Graphë¥¼ ì´ìš©í•œ Traditional ML ë°©ë²•ë¡ ë“¤ì— ëŒ€í•´ ì„¤ëª…í•œë‹¤.


### ğŸ’¡Traditional ML Pipeline

***Traditional ML Pipeline***ì€ í¬ê²Œ 2ë‹¨ê³„ë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤.

1. Data Point, Node, Link, Graph(ì´í•˜ **ì…ë ¥**)ë¥¼ Feature Vectorë¡œ ë³€í™˜í•´ MLëª¨ë¸ì„ í•™ìŠµì‹œí‚¨ë‹¤.
2. ìƒˆë¡œìš´ **ì…ë ¥**ì´ ë“¤ì–´ì˜¤ë©´ Feature Vectorë¥¼ ì–»ê³  ëª¨ë¸ì„ í†µí•´ ì˜ˆì¸¡í•œë‹¤.

---

### ğŸ’¡ Lecture Object : Feature Design

---

`Goal` : **ì…ë ¥** Setì´ ì£¼ì–´ì¡Œì„ë•Œ ì˜ˆì¸¡ê°’ì„ ë§Œë“¤ì–´ë‚´ëŠ”ê²ƒ / ëª¨ë¸ì€ ML Model ì‚¬ìš©

> Design Choice
> 
- Feature : $d$ì°¨ì›ì˜ ë²¡í„°
- ì…ë ¥ : Nodes, Links, Sets of Nodes, Entire Graph
- Objective Function : ë¬´ìŠ¨ Taskë¥¼ í’€ë ¤ê³  í•˜ëŠ”ê°€?

---

1. Traditional ML Pipelineì€ ìˆ˜ì‘ì—…ìœ¼ë¡œ ë§Œë“¤ì–´ì§„(Hand-Designed) Featureë¥¼ ì‚¬ìš©í•œë‹¤.
2. Hand Designed Featureë¥¼ Graphì˜ ì„¸ ë ˆë²¨ (Node, Link, Graph)ë¡œ ë‚˜ëˆ„ì–´ ì„¤ëª…í•œë‹¤.
3. Undirected Graphë¥¼ ì¤‘ì ìœ¼ë¡œ ì„¤ëª…í•œë‹¤.

---

## ğŸ”´Â Traditional Feature-Based Method : Node


> **Goal : Networkì—ì„œ Nodeì˜ êµ¬ì¡°ì™€ ìœ„ì¹˜ë¥¼ íŠ¹ì •í•  ìˆ˜ ìˆëŠ” Featureë¥¼ ë§Œë“œëŠ” ê²ƒ**


### ğŸ’¡ 1. Node Degree ($k_v$)

Node $v$ ì˜ Degreeë¥¼ $k_v$ ë¼ê³  ì •ì˜í•˜ì. ì´ë•Œ $k_v$ ëŠ” $v$ ê°€ ê°–ê³ ìˆëŠ” Edge(Link)ì˜ ìˆ˜ì™€ ê°™ë‹¤.

![](https://i.imgur.com/bRvU9Xz.png)



### ğŸ’¡ 2. Node Centrality(**$c_v$**)

Node DegreeëŠ” ë‹¨ìˆœíˆ ì´ì›ƒí•œ Nodeì˜ ê°¯ìˆ˜ë¥¼ ì„¸ë¯€ë¡œ, ê·¸ê²ƒë“¤ì˜ ì¤‘ìš”ë„ë¥¼ Captureí•  ìˆ˜ ì—†ë‹¤. 

Node Centrality($c_v$)ëŠ” Graphì—ì„œ í•´ë‹¹ Node( $v$)ì˜ ì¤‘ìš”ë„ë¥¼ í¬í•¨ì‹œí‚¨ ê°œë…ì´ë‹¤. 

- **2-1. Engienvector centrality**
    - `Important` : $v$ê°€ *Important* ì´ì›ƒë…¸ë“œ $u$ì— ë‘˜ëŸ¬ì‹¸ì—¬ ìˆì„ ë•Œ $v$ëŠ” *Important*í•˜ë‹¤ê³  í•œë‹¤.
    - `Formula`
        - $c_v = {1 \over \lambda} \sum\limits_{u\in N(v)}c_u$ ($\lambda$ëŠ” Normalization ìƒìˆ˜) â‡’ ì´ë ‡ê²Œ í•˜ë©´ Recursiveí•¨
        - $\lambda c= Ac$ ($A$ëŠ” Adjacency Matrix)
            - ê³ ìœ ê°’ê³¼ ê³ ìœ ë²¡í„° í˜•íƒœë¡œ ì¬ì„¤ì •
            - $c$ëŠ” $A$ì˜ ê³ ìœ ë²¡í„°, $\lambda$ëŠ” ê³ ìœ ê°’ì´ë©° $\lambda_{max}$ëŠ” í•­ìƒ ì–‘ìˆ˜ì— Uniqueí•¨
- **2-2. Betweenness centrality**
    - `Important` : $v$ê°€ ë‹¤ë¥¸ ë…¸ë“œë“¤ì„ ì—°ê²°í•˜ëŠ” ìµœë‹¨ ê²½ë¡œì— ìˆì„ë•Œ *Important*í•˜ë‹¤ê³  í•œë‹¤.(ê²½ìœ )
    - `Formula`  : $c_v = \sum\limits_{s \neq v \neq t}{vë¥¼\ í¬í•¨í•˜ëŠ” sì™€\ tì‚¬ì´ \ ìµœë‹¨\ ê²½ë¡œ \over sì™€\ tì‚¬ì´\ ìµœë‹¨\ ê²½ë¡œ}$
        
        ![](https://i.imgur.com/xh0zsGH.png)
        
- **2-3. Closeness Centrality**
    - `Important` :  $v$ê°€ ë‹¤ë¥¸ ëª¨ë“  ë…¸ë“œì— ëŒ€í•œ ìµœë‹¨ ê²½ë¡œì˜ ê¸¸ì´ê°€ ì§§ì„ë•Œ *Important*í•˜ë‹¤ê³  í•œë‹¤.
    - `Formula` : $c_v = 1 \div  \sum\limits_{u \neq v} (uì™€\ vì‚¬ì´ì˜\ ìµœë‹¨ê²½ë¡œì˜\ ê¸¸ì´)$
        
        ![](https://i.imgur.com/QA0e7Hi.png)
        

---


### ğŸ’¡ 3. Clustering Coefficient

***Clustering Coefficient***ëŠ” Node $v$ì˜ ì´ì›ƒë“¤ì´ ì–¼ë§ˆë‚˜ ì—°ê²°ë˜ì–´ ìˆëŠ”ì§€ë¥¼ ì¸¡ì •í•˜ëŠ” ê°œë…ì´ë‹¤.

$v$ì˜ ì´ì›ƒê°„ ì—°ê²°ëœ ê²½ìš°ì˜ ìˆ˜ë¥¼ ì´ì›ƒ Nodeë“¤ì´ ì„œë¡œ ì—°ê²°ë  ìˆ˜ ìˆëŠ” ì „ì²´ ê²½ìš°ì˜ ìˆ˜ë¡œ ë‚˜ëˆ„ì–´ì¤€ë‹¤.

![](https://i.imgur.com/WSxpVTm.png)

![](https://i.imgur.com/g7wDAiK.png)

---

### ğŸ¤” 4. Graphlets***


---

`Observation` : Clustering CoefficientëŠ” Ego-Networkì˜ #(Triangle)ì„ ì„¼ë‹¤)

- Ego-Network : Nodeê°€ ì£¼ì–´ì¡Œì„ë•Œ ìê¸°ìì‹ ê³¼ 1ì°¨-ì´ì›ƒë§Œ í¬í•¨í•œ Network
- #(Triangle) : 3ê°œì˜ ë…¸ë“œê°€ ì—°ê²°ë˜ì–´ ìˆëŠ” ê²ƒ
- ì´ëŸ° Triangle Countingì„ ë‹¤ì–‘í•œ êµ¬ì¡°ì— ëŒ€í•´ ì¼ë°˜í™” í•˜ëŠ”ê²ƒ â‡’ Graphletsì˜ ê°œë…

![](https://i.imgur.com/oANu76X.png)

---

- Graphletì˜ ëª©ì  : Node $u$ì˜ ì´ì›ƒ êµ¬ì¡°ë¥¼ ê¸°ìˆ í•˜ëŠ” ê²ƒ
    - Graphlets : $u$ì˜ ì´ì›ƒ êµ¬ì¡°ë¥¼ ê¸°ìˆ í•˜ê¸° ìœ„í•œ ì‘ì€ Subgraph(Template?)
        
        ![](https://i.imgur.com/Rih91Sq.png)
        

---

> ***Graphlet Degree Vector(GDV)*** : Nodeì˜ Graphelt-Based Feature
> 
- Degree of Graphlet : íŠ¹ì • Nodeê°€ í¬í•¨ëœ Graphletì˜ ê°¯ìˆ˜ ë²¡í„°ì´ë‹¤. 
ì–´ë–»ê²Œ ì„¸ëŠ”ì§€ëŠ” ì•„ë˜ì˜ ì˜ˆì‹œë¥¼ í†µí•´ ì„¤ëª…í•œë‹¤.

---

1. ì•„ë˜ì™€ ê°™ì´ ìƒê¸´ Graph $G$ì—ì„œ Node $u$ì— ê´€ì‹¬ìˆë‹¤ê³  ê°€ì •í•´ ë³´ì.
    
    ![](https://i.imgur.com/6wbUZqm.png)
    
2. Graph êµ¬ì¡°ë¥¼ ë³´ì•˜ì„ë•Œ, ìµœëŒ€ 3ê°œì˜ Nodeê°€ ì°¸ì—¬í•˜ëŠ” Graphletì„ ë§Œë“¤ ìˆ˜ ìˆë‹¤.
    
    ![](https://i.imgur.com/3uIYSMl.png)
    
3. ê°ê°ì˜ Graphletì´ $G$ì—ì„œ $u$ë¥¼ í¬í•¨í•œì±„ë¡œ ëª‡ë²ˆ ë‚˜íƒ€ë‚˜ëŠ”ì§€ ì„¸ë³´ì

    ![](https://i.imgur.com/3HqOtKv.png)

4. Node $u$ì˜ GDVëŠ” [2,1,0,2]ê°€ ëœë‹¤.

> ***Graphlet Summary*** 

    2~5ê°œì˜ Nodeê°€ ì°¸ì—¬í•˜ëŠ” Graphletì˜ ê°¯ìˆ˜ëŠ” 73ê°œì´ë‹¤. ì´ë¥¼ 73ì°¨ì›ì˜ ë²¡í„°ë¡œ í‘œì‹œí•  ìˆ˜ ìˆê³ , ê° IndexëŠ” íŠ¹ì •í•œ Neighborhood Topologyì— Signatureì´ë‹¤. ì´ ë²¡í„°ë¥¼ ì´ìš©í•´ Nodeì˜ Local Network Topologyë¥¼ ì˜ ì •ì œëœ Featureë¡œ ë§Œë“ ê²Œ GDVì´ë©°, ì•ì—ì„œ ì†Œê°œí•œ ë°©ì‹ë³´ë‹¤ ìì„¸í•œ ì •ë³´ë¥¼ ê°–ê³ ìˆë‹¤.


### ğŸ’¡ Node-Level Feature Summary


    Node Level FeatureëŠ” 2ê°€ì§€ ë¶„ë¥˜ë¡œ ë‚˜ëˆŒìˆ˜ ìˆë‹¤

    1. Importance Based (Ex Task : ì˜í–¥ë ¥ìˆëŠ” Nodeì°¾ê¸°(SNSì˜ ì…€ëŸ½ì°¾ê¸°))
        1. Node Degree : ë‹¨ìˆœíˆ ì´ì›ƒì˜ ìˆ«ìë¥¼ ì„¼ë‹¤
        2. Node Centrality : Graphì—ì„œì˜ ì´ì›ƒ ë…¸ë“œì˜ ì¤‘ìš”ë„ë¥¼ ëª¨ë¸ë§í•œë‹¤.
    2. Structure Based (Ex Task : Nodeì˜ ì—­í•  ì°¾ê¸°(ë‹¨ë°±ì§ˆ êµ¬ì¡°ì—ì„œ íŠ¹ì • ë‹¨ë°±ì§ˆì˜ ê¸°ëŠ¥ì°¾ê¸°))
        1. Node Degree : ë‹¨ìˆœíˆ ì´ì›ƒì˜ ìˆ«ìë¥¼ ì„¼ë‹¤
        2. Clustering Coefficient : ì´ì›ƒì´ ì–´ë–»ê²Œ ì—°ê²°ë˜ì–´ìˆëŠ”ì§€ ì¸¡ì •í•œë‹¤.
        3. Graphlet Count Vector : ì—¬ëŸ¬ Graphletë“¤ì´ ì¶œí˜„í•˜ëŠ” ë¹ˆë„ë¥¼ ì„¼ë‹¤.

---

## ğŸ”—Â Traditional Feature-Based Method : Link

---


### ğŸ’¡ Link-Level Prediction Task

Link-Level TaskëŠ” ì¡´ì¬í•˜ëŠ” Linkë¥¼ ë°”íƒ•ìœ¼ë¡œ ìƒˆë¡œìš´ Linkë¥¼ ì˜ˆì¸¡í•˜ëŠ” ê²ƒì´ë‹¤. Linkë¥¼ ì˜ˆì¸¡í•˜ëŠ” TaskëŠ” í¬ê²Œ 2ê°€ì§€ Formulationì´ ìˆë‹¤.

> ***1. ëœë¤í•˜ê²Œ ì‚¬ë¼ì§„ Link ì°¾ê¸° :*** Staticí•œ Graphì— ì ì ˆí•˜ë‹¤.

> ***2. ì‹œê°„ì´ íë¦„ì— ë”°ë¼ ìƒê²¨ë‚˜ëŠ” Link ì°¾ê¸° :*** SNS, Transactionê°™ì´ Dynamicí•œ Graphì— ì ì ˆí•˜ë‹¤.
 

Link-Level Predictionì˜ ìì„¸í•œ ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

1. ê° NodeìŒ ($x,y)$ì— score $c(x,y)$ë¥¼ ê³„ì‚°í•œë‹¤.
2. $c(x,y)$ ë‚´ë¦¼ì°¨ìˆœìœ¼ë¡œ Node ìŒì„ ì •ë ¬í•œë‹¤
3. Top $N$ê°œì˜ Pairë“¤ì„ ìƒˆë¡œìš´ Linkë¡œ ì˜ˆì¸¡í•œë‹¤.

---


### ğŸ’¡ Link - Level Feature : Distance-Based Features

</aside>

> ***1. ë…¸ë“œê°„ ìµœë‹¨ ê²½ë¡œ***
> 

ë‘ Nodeê°„ ìµœë‹¨ê²½ë¡œì˜ ê±°ë¦¬ë¥¼ ì‚¬ìš©í•œë‹¤. ì´ì›ƒì˜ ìˆ˜ë‚˜ ê°•ë„ì— ëŒ€í•œ ì–´ë– í•œ ì •ë³´ë„ ìº¡ì³í•˜ì§€ ì•ŠëŠ”ë‹¤.

> ***2. Local Neighborhood Overlap***
> 

ë‘ Nodeê°€ ê³µìœ í•˜ëŠ” ì´ì›ƒì„ ìº¡ì³í•œë‹¤.

- **Coomon Neighbors** : ë‹¨ìˆœíˆ êµì§‘í•©ì„ êµ¬í•œë‹¤
- **Jaccardâ€™s Coefficient** : êµì§‘í•©ì˜ í¬ê¸°ë¥¼ í•©ì§‘í•©ìœ¼ë¡œ ë‚˜ëˆˆë‹¤
- **Adamic-Adar Index** : (SNSì—ì„œ ì˜ ë™ì‘í•œë‹¤ê³  í•˜ë„¤ìš”)
ë‘ Nodeê°€ ê³µìœ í•˜ëŠ” ì´ì›ƒì„ uë¼ê³  í•  ë•Œ $\sum \limits_u {1\over log(k_u)}$

> ***3. Global Neighborhood Overlap***
> 

Local Neighborhood Overlapì˜ ë‹¨ì ì€ ì ì¬ì  ì´ì›ƒë„ ì§ì ‘ì ì¸ ê³µí†µ ì´ì›ƒì´ ì—†ìœ¼ë©´ 0ì´ ëœë‹¤ëŠ” ì ì´ë‹¤.

![](https://i.imgur.com/xWSmHWZ.png)

- **Katz Index** : ì£¼ì–´ì§„ Node ìŒì„ ì‡ëŠ” ëª¨ë“  ê¸¸ì´ì˜ ê²½ë¡œë¥¼ ì„¼ë‹¤. Matrixë¥¼ ì´ìš©í•´ ê¹”ë”í•˜ê²Œ ì—°ì‚°í• ìˆ˜ ìˆë‹¤.
    - $A_{uv}$ëŠ” ì§ì ‘ ì´ì›ƒì¼ ë•Œ 1ì´ê³  ì•„ë‹ˆë©´ 0ì´ë‹¤.
    - $P_{uv}^{(K)}$ëŠ” $K$ê¸¸ì´ì˜ $u,v$ë¥¼ ì‡ëŠ” ê²½ë¡œì´ë‹¤.
    - $P^{(K)}$ = $A^k$ì´ë‹¤.
    - `Formula`
        - $S_{uv} = \sum \limits_{l=1}^\infty
        \beta^l A_{uv}^{l}$ ($l$ : Pathì˜ ê¸¸ì´, $\beta$: Discount Factor($0<\beta<1$)
        - $S_{uv} = \sum \limits_{l=1}^\infty \beta^lA^i=(I-\beta A)^{-1}-I$ (Closed-Form)

### ğŸ’¡Link-Level Feature Summary


    Link Level FeatureëŠ” 3ê°€ì§€ ë¶„ë¥˜ë¡œ ë‚˜ëˆŒìˆ˜ ìˆë‹¤

    1. Distance-Based :ë‘ Nodeê°„ ìµœë‹¨ê²½ë¡œì˜ ê±°ë¦¬
    2. Local Neigborhood Overlap : ë‘ Nodeê°€ ê³µìœ í•˜ëŠ” ì´ì›ƒì˜ ìˆ˜
    3. Global Neighborhood Overlap : ë‘ Nodeë¥¼ ì‡ëŠ” ëª¨ë“  ê¸¸ì´ì˜ ê²½ë¡œ ê°€ì¤‘í•©

---

## â›“Â Traditional Feature-Based Method : Graph

---

> **Goal : ì „ì²´ Graph êµ¬ì¡°ë¥¼ íŠ¹ì •í•  ìˆ˜ ìˆëŠ” Featureë¥¼ ë§Œë“œëŠ” ê²ƒ**
> 
- ì•„ì´ë””ì–´ : Graphë¡œ Featureë¥¼ ì§ì ‘ ë§Œë“œëŠ” ëŒ€ì‹  Kernelì„ ë§Œë“¤ì.
    - Kernel $K(G,G') \in \R$ ì€ ë‘ Graph$(G)$ ì‚¬ì´ì˜ ìœ ì‚¬ë„ë¥¼ ì¸¡ì •í•œë‹¤.
    - Kernel MatrixëŠ” í•­ìƒ ì–‘ì˜ ê³ ìœ ê°’ì„ ê°–ê³  ëŒ€ì¹­í–‰ë ¬ ì´ì–´ì•¼í•œë‹¤.
    - Feature Representaiton $\phi(.)$ì´ ì¡´ì¬í•œë‹¤.
    - ì´ Kernelì„ SVMë“±ì— ë¶™ì—¬ì„œ ì‚¬ìš©í•œë‹¤.

---


### ğŸ’¡ Kernel Method

- **Goal :** Graph Feature Vector $\phi(G)$ë¥¼ ì„¤ê³„í•œë‹¤
- **Idea :** Graphì— ëŒ€í•´ Bowë¥¼ ë§Œë“ ë‹¤.
    - *Bow* : NLPì—ì„œ ëª¨ë“  ë‹¨ì–´ê°€ ëª‡ ë²ˆ ë‚˜íƒ€ë‚˜ëŠ”ì§€ ì„¸ëŠ” ë°©ë²•
    - *Naive Solution* : Nodeë¥¼ Wordë¡œ ì‚¬ìš©í•œë‹¤. ê·¸ëŸ¬ë‚˜ ë„ˆë¬´ Naiveí•´ì„œ ì¨ë¨¹ê¸° ì–´ë µë‹¤.
        
        ![](https://i.imgur.com/c7WNp0e.png)
        
    - *Node Degrees* : Node Degreeë¥¼ Wordë¡œ ì‚¬ìš©í•œë‹¤.
        
        ![](https://i.imgur.com/nLC4jnv.png)
        
    - ì´ëŸ°ì‹ì˜ Bag-of-something ë°©ì‹ì´ Graphlet Kernelê³¼ WL Kernelì—ì„œë„ ì‚¬ìš©ëœë‹¤.

---


### ğŸ’¡ Grahplet Features


- **Idea** : Graphì— ì¡´ì¬í•˜ëŠ” ì„œë¡œ ë‹¤ë¥¸ Graphletì˜ ìˆ«ìë¥¼ ì„¸ì
- **Note :** ì´ë•Œì˜ Graphletì€ Node-Levelê³¼ ì¡°ê¸ˆ ë‹¤ë¥¸ ì •ì˜ë¥¼ ê°–ê³ ìˆë‹¤.
    - Isolated Nodeë¡œ Graphletì˜ ì¼ë¶€ë¡œ í—ˆìš©í•œë‹¤.
    - Root Nodeê°€ ì—†ë‹¤.
    
    ![](https://i.imgur.com/RCZYqWd.png)
    
- Graph $G$ì™€ Graphlet list $g_k = (g_1,g_2 ...g_{nk})$ê°€ ì£¼ì–´ì¡Œì„ ë•Œ
Graphlet Count Vector $f_G \in \R^{nk}$ ëŠ” Graphì—ì„œ ë‚˜íƒ€ë‚˜ëŠ” ê° Graphletì˜ ì¸ìŠ¤í„´ìŠ¤ ìˆ˜ë¡œ ì •ì˜ëœë‹¤.
    - $(f_G)_i = \#(g_i \in G)$ | (for $i = 1,2,...n_k)$
        
        ![](https://i.imgur.com/15aKkBh.png)
        


### ğŸ’¡ Graphlet Kernel

- 2ê°œì˜ Graph $G$ ì™€ $G'$ê°€ ì£¼ì–´ì§€ë©´, Graphlet Kernelì€ $K(G,G') = {f_G}^Tf_{G'}$ë¡œ í‘œí˜„ë  ìˆ˜ ìˆë‹¤(ë‚´ì )
- `Problem` : $G$ ì™€ $G'$ê°€ í¬ê¸°(Scale)ì´ ë‹¤ë¥´ë©´ ê°’ì´ í¬ê²Œ ì™œê³¡ëœë‹¤.
- `Solution`: $f_G$  ëŒ€ì‹  Sumìœ¼ë¡œ ë‚˜ëˆ ì¤€ $h_G$ë¥¼ ì‚¬ìš©í•œë‹¤.  $h_G = {f_G \over Sum(f_G)}$
- `Limitation` : Graphletì„ ì„¸ëŠ” ì—°ì‚°ì´ ë§¤ìš° Expensiveí•˜ë‹¤ !
    - $n$ í¬ê¸°ì˜ Graphì˜ $k$ í¬ê¸°ì˜ Graphletë¥¼ ì„¸ë ¤ë©´ $n^k$ë²ˆ ì—°ì‚°í•´ì•¼ í•œë‹¤.

---


### ğŸ’¡ Weisfeiler-Lehman(WL) Kernel

- **Goal :** íš¨ìœ¨ì ì¸ Graph Feature Descriptorë¥¼ ë§Œë“œëŠ” ê²ƒ
    - WL-Kernelì€ ê°•ë ¥í•˜ê³  íš¨ìœ¨ì ì´ì–´ì„œ ì¸ê¸°ê°€ ë§ë‹¤.
- **Idea :** Node Degreeë¥¼ ì´ìš©í•´ ë°˜ë³µì ìœ¼ë¡œ Node Vocapì„ í’ë¶€í•˜ê²Œ ë§Œë“¤ì–´ ë‚˜ê°€ëŠ” ê²ƒ
    - One-Hop Neighborhoodì¸ Node Degree ë°©ì‹ì„ ì¼ë°˜í™” í•œ ë²„ì „ì´ë‹¤.
    - ***Color Refinement*** ì•Œê³ ë¦¬ì¦˜ì„ í†µí•´ ì´ë£¨ì–´ì§„ë‹¤.
- **ê° Stepì—ì„œì˜ Time-Complexityê°€ Edgeì— ë”°ë¼ Linearí•˜ê²Œ ì¦ê°€í•œë‹¤.**


### ğŸ’¡ Color Refinement

- `Given` : Graph $G$ì™€ ê·¸ê²ƒë“¤ì˜ Set of Nodes $V$
    
    1. Initial Color $c^{(0)}(v)$ë¥¼ ê° ë…¸ë“œ $v$ì— í• ë‹¹í•œë‹¤
    2. Iterativelyí•˜ê²Œ Nodeì˜ Colorë¥¼ ì •ì œí•´ ë‚˜ê°„ë‹¤.
    $c^{(k+1)}(v) = HASH(\{c^{(k)}(v), \{c^{(k)}(u) \}_{u\in N(v)})$
        - HASHëŠ” ë‹¤ë¥¸ ì…ë ¥ì„ ë‹¤ë¥¸ Colorë¡œ ë§¤í•‘í•˜ëŠ” ì—°ì‚°ì´ë‹¤.
    3. $K$ Step ë™ì•ˆì˜ ì •ì œê°€ ëë‚˜ë©´ $c^{(K)}(v)$ ê°’ì„ Summaryí•œë‹¤.
    
    ---
    
    - ë¹„ìŠ·í•˜ì§€ë§Œ ì¡°ê¸ˆ ë‹¤ë¥¸ Graph ë‘ê°œ ($G_1, G_2$)ê°€ ì£¼ì–´ì¡Œì„ë•Œ Color Refienment ì˜ˆì‹œì´ë‹¤
    
        1. ë™ì¼í•œ Initial Colorë¥¼ ëª¨ë“  Nodeì— í• ë‹¹í•œë‹¤.
    
            ![](https://i.imgur.com/MbNlENL.png)
    
        2. ì´ì›ƒí•˜ëŠ” ìƒ‰ìƒì— ëŒ€í•´ Aggregateí•œë‹¤.
        
            ![](https://i.imgur.com/qsIdHIv.png)
        
        3. Aggregateëœ Colorë¥¼ HASHí•œë‹¤.
        
            ![](https://i.imgur.com/ARtbUYJ.png)
        
        4. ì´ì›ƒí•˜ëŠ” ìƒ‰ìƒì— ëŒ€í•´ Aggregateí•œë‹¤.
        
            ![](https://i.imgur.com/54MxJxX.png)
        
        5. Aggregateëœ Colorë¥¼ HASHí•œë‹¤.
        
            ![](https://i.imgur.com/jzDMsuL.png)
        
        6. Color Refinementê°€ ëë‚˜ë©´ WL Kernelì´ ê° Colorê°€ ë“±ì¥í–ˆë˜ íšŸìˆ˜ë¥¼ ì„¸ì„œ Summaryí•œë‹¤.
        
            ![](https://i.imgur.com/l2oEW8J.png)
        
        7. Color Count Vectorë¥¼ ë‚´ì í•´ WL Kernelì˜ ê²°ê³¼ê°’ì„ êµ¬í•œë‹¤.
        
            ![](https://i.imgur.com/XXN2ldt.png)
        

---


### ğŸ’¡ ***Graph-Level Feature Summary***

    Graph Level FeatureëŠ” Kernelì„ ì´ìš©í•œë‹¤.

    1. Graphlet Kernel :Bag-of-Graphlets, Computationally Expensive
    2. WL- Kernel :
        - Color-Refinement ì•Œê³ ë¦¬ì¦˜ì„ ì´ìš©í•´ ë°˜ë³µì ìœ¼ë¡œ í”¼íŒ…
        - Bag-of-Colors
        - Computationally Efficient !
        - Closely related to Graph Neural Networks
